{% extends "layout.html" %}
{% block content %}
<script>
var interestToggle = function(element, bookkey){
  var value = element.getElementsByTagName("input")[0].checked
  var http = new XMLHttpRequest();
  http.open("GET", window.origin + "/interest/" + bookkey + "?value=" + value, true);
  http.send();
  element.getElementsByTagName("input")[0].checked = value;
  return true;
}
</script>
    {% if my_books.count(1) > 0 %}
    <h3>My Books:</h3>
    <ul class="mdl-list">
      {% for book in my_books %}
        <li class="mdl-list__item--three-line">
          <span class="mdl-list__item-primary-content">
            <span class="material-icons mdl-list__item-icon" id="book{{ loop.index}}">bookmark</span>
            <span class="mdl-tooltip mdl-tooltip--large" for="book{{ loop.index}}">This Book is your book.</span>
            <a href="/book/{{ book.key.urlsafe() }}">{{ book.title }}</a>
            <span class="mdl-list__item-text-body">
              Author(s):{{ book.author | join(',') }}
            </span>
          </span>
        </li>
      {% endfor %}
    </ul>
    {% endif %}
    <h2>Books:</h2>
    <ul class="mdl-list">
      {% for book in books %}
        <li class="mdl-list__item--three-line">
          <span class="mdl-list__item-primary-content">
            <span>
            {% if book.is_available() %}
            <a href="/borrow/{{ book.key.urlsafe() }}">
              <span class="material-icons mdl-list__item-icon"
                  id="browse.book{{loop.index}}">turned_in</span>
              <span class="mdl-tooltip mdl-tooltip--large" for="browse.book{{ loop.index}}">
              Borrow This Book</span>
            </a>
            {% else %}
            <span class="material-icons mdl-list__item-icon"
                  id="browse.book{{loop.index}}">turned_in_not</span>
              <span class="mdl-tooltip mdl-tooltip--large" for="browse.book{{ loop.index}}">
              Book loaned out, not available for borrowing.</span>
            {% endif %}
            <label class="mdl-icon-toggle mdl-js-icon-toggle mdl-js-ripple-effect"
                for="interest/{{book.key.urlsafe()}}"
                onchange='interestToggle(this, "{{book.key.urlsafe()}}")'
                >
            <input type="checkbox" id="watch.book{{loop.index}}"
                class="mdl-icon-toggle__input"
                  {% if book.get_interest() == True %}checked="checked"{% endif %} />
            <span class="mdl-icon-toggle__label material-icons"
                id="eyeball{{loop.index}}">visibility</span>
            <span class="mdl-tooltip mdl-tooltip--large" for="eyeball{{ loop.index }}">
            Book loaned out, not available for borrowing.</span>
</label>
            <a href="/book/{{ book.key.urlsafe() }}">{{ book.title }}</a>
            <span class="mdl-list__item-text-body">
              Author(s):{{ book.author | join(',') }}
            </span>
        </li>
      {% endfor %}
    </ul>
{% endblock %}
